<div
  class="flex min-h-screen items-center justify-center bg-surface-container-lowest px-4 py-12 sm:px-6 lg:px-8"
>
  <div class="w-full max-w-md space-y-8">
    <!-- Email Sent Success State -->
    @if (isEmailSent()) {
      <!-- Success Icon -->
      <div
        class="mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-success-container"
      >
        <mat-icon class="text-2xl text-on-success-container">check_circle</mat-icon>
      </div>

      <!-- Success Header -->
      <div class="text-center">
        <h1 class="text-3xl font-bold tracking-tight text-on-surface">Check your email</h1>
        <p class="mt-2 text-sm text-on-surface-variant">
          We've sent a password reset link to your email address. Please check your inbox and follow
          the instructions.
        </p>
      </div>

      <!-- Success Message -->
      <div class="rounded-lg bg-surface-container p-6 text-center">
        <p class="text-sm text-on-surface-variant mb-4">
          Didn't receive the email? Check your spam folder or try again.
        </p>
        <button
          matButton="outlined"
          type="button"
          (click)="resendResetLink()"
          [disabled]="isLoading()"
          color="primary"
        >
          @if (isLoading()) {
            <mat-spinner diameter="16" class="mr-2"></mat-spinner>
            Sending...
          } @else {
            <mat-icon class="mr-2">refresh</mat-icon>
            Resend email
          }
        </button>
      </div>

      <!-- Back to Sign In -->
      <button matButton="filled" type="button" class="w-full" href="/sign-in" color="primary">
        <mat-icon class="mr-2">arrow_back</mat-icon>
        Back to sign in
      </button>
    }

    <!-- Email Input Form State -->
    @else {
      <!-- Icon -->
      <div
        class="mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-primary-container"
      >
        <mat-icon class="text-2xl text-on-primary-container">email</mat-icon>
      </div>

      <!-- Header -->
      <div class="text-center">
        <h1 class="text-3xl font-bold tracking-tight text-on-surface">Forgot your password?</h1>
        <p class="mt-2 text-sm text-on-surface-variant">
          Enter your email address and we'll send you a link to reset your password.
        </p>
      </div>

      <!-- Forgot Password Form -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="sendResetLink()" class="mt-8 space-y-6">
        <!-- Email Field -->
        <mat-form-field appearance="outline" class="w-full">
          <mat-label>Email address</mat-label>
          <input
            matInput
            type="email"
            formControlName="email"
            autocomplete="email"
            placeholder="Enter your email"
            required
          />
          @if (
            forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched
          ) {
            <mat-error>
              @if (forgotPasswordForm.get('email')?.hasError('required')) {
                Email is required
              } @else if (forgotPasswordForm.get('email')?.hasError('email')) {
                Please enter a valid email address
              }
            </mat-error>
          }
        </mat-form-field>

        <!-- Send Reset Link Button -->
        <button
          matButton="filled"
          type="submit"
          class="w-full"
          [disabled]="isLoading() || forgotPasswordForm.invalid"
          color="primary"
        >
          @if (isLoading()) {
            <mat-spinner diameter="20" class="mr-2"></mat-spinner>
            Sending reset link...
          } @else {
            Send reset link
          }
        </button>
      </form>

      <!-- Back to Sign In Link -->
      <p class="mt-8 text-center text-sm text-on-surface-variant">
        Remember your password?
        <a href="/sign-in" class="font-medium text-primary hover:text-primary-container underline">
          Sign in here
        </a>
      </p>
    }
  </div>
</div>
